<!DOCTYPE html>
<html>
<head>
<link href="https://fonts.googleapis.com/css?family=Montserrat:300,400,700|Roboto:400,700" rel="stylesheet">
<title>GenderValues Results</title>
<link rel="icon" type="x-icon" href="icon.png">
<link rel="shortcut icon" type="x-icon" href="icon.png">
<meta charset="utf-8">
<style>
    body { font-family: 'Roboto', sans-serif; background-color: #eeeeee; padding: 20px; text-align: center; }
    h1 { font-family: 'Montserrat', sans-serif; font-weight: 700; }
    h2 { font-family: 'Montserrat', sans-serif; font-weight: 400; }
    .axis { display: flex; align-items: center; justify-content: center; margin-bottom: 20px; }
    .bar { height: 50px; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; transition: width 0.5s; }
    .text-wrapper { padding: 0 10px; }
    
    /* Colors for the Gender Axes */
    .fem { background-color: #f06292; } /* Pink */
    .masc { background-color: #2196f3; } /* Blue */
    .soft { background-color: #ba68c8; } /* Purple */
    .hard { background-color: #4db6ac; } /* Teal */
    .andro { background-color: #ffb74d; } /* Orange */
    .distinct { background-color: #90a4ae; } /* Grey-Blue */
    .unique { background-color: #9c27b0; } /* Deep Purple */
    .classic { background-color: #81c784; } /* Green */

    .button { padding: 10px 20px; font-size: 18px; cursor: pointer; background-color: #2196f3; color: white; border: none; border-radius: 5px; }
    img { margin: 0 10px; }
    #banner { max-width: 100%; height: auto; margin-top: 20px; border: 2px solid #ccc; }
</style>
</head>

<body>
<h1>GenderValues</h1>
<hr>
<h1>Results</h1>

<h2>Expression: <span class="weight-300" id="expression-label"></span></h2>
<div class="axis">
    <img id="img-fem" src="value_images/feminine.svg" height="80pt" alt="Fem"/>
    <div class="bar fem" id="bar-fem"><div class="text-wrapper" id="fem"></div></div>
    <div class="bar masc" id="bar-masc"><div class="text-wrapper" id="masc"></div></div>
    <img id="img-masc" src="value_images/masculine.svg" height="80pt" alt="Masc"/>
</div>

<h2>Energy: <span class="weight-300" id="energy-label"></span></h2>
<div class="axis">
    <img id="img-soft" src="value_images/soft.svg" height="80pt" alt="Soft"/>
    <div class="bar soft" id="bar-soft"><div class="text-wrapper" id="soft"></div></div>
    <div class="bar hard" id="bar-hard"><div class="text-wrapper" id="hard"></div></div>
    <img id="img-hard" src="value_images/hard.svg" height="80pt" alt="Hard"/>
</div>

<h2>Silhouette: <span class="weight-300" id="silhouette-label"></span></h2>
<div class="axis">
    <img id="img-andro" src="value_images/andro.svg" height="80pt" alt="Andro"/>
    <div class="bar andro" id="bar-andro"><div class="text-wrapper" id="andro"></div></div>
    <div class="bar distinct" id="bar-distinct"><div class="text-wrapper" id="distinct"></div></div>
    <img id="img-distinct" src="value_images/distinct.svg" height="80pt" alt="Binary"/>
</div>

<h2>Style: <span class="weight-300" id="style-label"></span></h2>
<div class="axis">
    <img id="img-unique" src="value_images/unique.svg" height="80pt" alt="Unique"/>
    <div class="bar unique" id="bar-unique"><div class="text-wrapper" id="unique"></div></div>
    <div class="bar classic" id="bar-classic"><div class="text-wrapper" id="classic"></div></div>
    <img id="img-classic" src="value_images/classic.svg" height="80pt" alt="Classic"/>
</div>

<h2>Closest Match: <span class="weight-300" id="ideology-label"></span></h2>
<p>Presentation matching is a work in progress! Stay fabulous, good girl. :3</p>

<hr/>
<canvas id="mainCanvas" style="display:none;"></canvas>
<img src="" id="banner">
<br><br>
<button class="button" onclick="location.href='index.html';">Back</button>

<script>
    // Configuration
    const version = "Gender Edit v1.0";
    
    // Result Labels
    const exprArray = ["High Femme", "Feminine", "Fem-leaning", "Neutral", "Masc-leaning", "Masculine", "High Masc"];
    const enerArray = ["Very Soft", "Soft", "Gentle", "Balanced", "Rugged", "Hard", "Industrial"];
    const silhArray = ["Purely Andro", "Blurry", "Fluid", "Mixed", "Structured", "Gendered", "Strictly Binary"];
    const stylArray = ["Totally Unique", "Experimental", "Eclectic", "Modern", "Traditional", "Classic", "Vintage"];

    function getQueryVariable(variable) {
        var query = window.location.search.substring(1);
        var vars = query.split("&");
        for (var i=0;i<vars.length;i++) {
            var pair = vars[i].split("=");
            if(pair[0] == variable) {return pair[1]}
        }
        return(50); // Default to 50% if not found
    }

    function setBarValue(name, value) {
        let innerel = document.getElementById(name);
        let outerel = document.getElementById("bar-" + name);
        outerel.style.width = (value + "%");
        innerel.innerHTML = (value + "%");
        if (value < 10) { innerel.style.display = "none"; }
    }

    function setLabel(val, ary) {
        if (val > 90) return ary[0];
        if (val > 75) return ary[1];
        if (val > 60) return ary[2];
        if (val >= 40) return ary[3];
        if (val >= 25) return ary[4];
        if (val >= 10) return ary[5];
        return ary[6];
    }

    // Capture Values
    const fem = parseFloat(getQueryVariable("f"));
    const soft = parseFloat(getQueryVariable("s"));
    const andro = parseFloat(getQueryVariable("a"));
    const unique = parseFloat(getQueryVariable("u"));

    const masc = (100 - fem).toFixed(1);
    const hard = (100 - soft).toFixed(1);
    const distinct = (100 - andro).toFixed(1);
    const classic = (100 - unique).toFixed(1);

    // Apply to UI
    setBarValue("fem", fem);
    setBarValue("masc", masc);
    setBarValue("soft", soft);
    setBarValue("hard", hard);
    setBarValue("andro", andro);
    setBarValue("distinct", distinct);
    setBarValue("unique", unique);
    setBarValue("classic", classic);

    document.getElementById("expression-label").innerHTML = setLabel(fem, exprArray);
    document.getElementById("energy-label").innerHTML = setLabel(soft, enerArray);
    document.getElementById("silhouette-label").innerHTML = setLabel(andro, silhArray);
    document.getElementById("style-label").innerHTML = setLabel(unique, stylArray);

    // Closest Match Placeholder
    document.getElementById("ideology-label").innerHTML = "Femgirl ^w^";

    // Canvas Image Generation
    window.onload = function() {
        var c = document.getElementById("mainCanvas");
        var ctx = c.getContext("2d");
        c.width = 800;
        c.height = 650;

        ctx.fillStyle = "#EEEEEE";
        ctx.fillRect(0,0,800,650);

        ctx.fillStyle="#222222";
        ctx.font="700 60px Montserrat";
        ctx.fillText("GenderValues", 20, 70);
        ctx.font="40px Montserrat";
        ctx.fillText(document.getElementById("ideology-label").innerHTML, 20, 120);

        // Draw Bars on Canvas
        function drawAxis(y, val, colorLeft, colorRight, label) {
            ctx.fillStyle="#222222";
            ctx.fillRect(120, y, 560, 60);
            ctx.fillStyle=colorLeft;
            ctx.fillRect(124, y+4, (5.52*val), 52);
            ctx.fillStyle=colorRight;
            ctx.fillRect(124+(5.52*val), y+4, (552-(5.52*val)), 52);
            
            ctx.fillStyle="#222222";
            ctx.font="700 20px Montserrat";
            ctx.textAlign="center";
            ctx.fillText(label, 400, y-10);
        }

        drawAxis(200, fem, "#f06292", "#2196f3", "Expression: " + document.getElementById("expression-label").innerHTML);
        drawAxis(320, soft, "#ba68c8", "#4db6ac", "Energy: " + document.getElementById("energy-label").innerHTML);
        drawAxis(440, andro, "#ffb74d", "#90a4ae", "Silhouette: " + document.getElementById("silhouette-label").innerHTML);
        drawAxis(560, unique, "#9c27b0", "#81c784", "Style: " + document.getElementById("style-label").innerHTML);

        document.getElementById("banner").src = c.toDataURL();
    }
</script>
</body>
</html>
